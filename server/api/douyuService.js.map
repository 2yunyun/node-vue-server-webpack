{"version":3,"sources":["douyuService.es6"],"names":[],"mappings":";;;;;;;;wDAMO,iBAA8B,OAA9B;AAAA,YAAsC,IAAtC,yDAA2C,CAA3C;AAAA;AAAA;AAAA;AAAA;AAAA,yDACI,8BAAQ,qBAAI,mBAAJ,GAA0B,UAA1B,GAAuC,sBAAY,MAAZ,CAAmB,OAAnB,CAAvC,GAAqE,GAArE,GAA2E,sBAAY,SAAZ,CAAsB;AACxG,kCAAM,CADkG;AAExG,kCAAM;AAFkG,yBAAtB,CAAnF,CADJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAe,c;;;;;QAON,gB,GAAA,gB;;AAbhB;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAUO,SAAS,gBAAT,CAA0B,OAA1B,EAAmC;AACtC,QAAI,IAAI,kBAAQ,IAAR,CAAa,OAAb,CAAR;;AAEA,QAAI,UAAU,EAAE,4BAAF,EAAgC,OAAhC,EAAd;AACA,QAAI,YAAY,EAAE,uCAAF,EAA2C,OAA3C,EAAhB;AACA,QAAI,cAAc,EAAE,qCAAF,EAAyC,OAAzC,EAAlB;AACA,QAAI,aAAa,EAAE,sCAAF,EAA0C,OAA1C,EAAjB;AACA,QAAI,aAAa,EAAE,wCAAF,EAA4C,OAA5C,EAAjB;AACA,QAAI,eAAe,EAAE,yCAAF,EAA6C,OAA7C,EAAnB;AACA,QAAI,iBAAiB,EAAE,sCAAF,EAA0C,OAA1C,EAArB;;AAEA,QAAI,WAAW,IAAI,KAAJ,CAAU,QAAQ,MAAlB,CAAf;AACA,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,QAAQ,MAA5B,EAAoC,GAApC,EAAyC;AACrC,iBAAS,CAAT,IAAc;AACV,mBAAO,YAAY,CAAZ,EAAe,QAAf,CAAwB,CAAxB,EAA2B,IADxB;AAEV,kBAAM,QAAQ,CAAR,EAAW,OAAX,CAAmB,IAFf;AAGV,iBAAK,UAAU,CAAV,EAAa,OAAb,CAAqB,eAArB,CAHK;AAIV,kBAAM,WAAW,CAAX,EAAc,QAAd,CAAuB,CAAvB,EAA0B,IAJtB;AAKV,kBAAM,WAAW,CAAX,EAAc,QAAd,CAAuB,CAAvB,EAA0B,IALtB;AAMV,oBAAQ,aAAa,CAAb,EAAgB,QAAhB,CAAyB,CAAzB,EAA4B,IAN1B;AAOV,sBAAU,CAAC,CAAC,eAAe,CAAf,CAAF,GAAoB,IAApB,GAAyB;AAPzB,SAAd;AASH;;AAED,QAAI,QAAQ,CAAZ;AACA,QAAI;AACA,YAAI,QAAQ,EAAE,kCAAF,EAAsC,OAAtC,EAAZ;AACA,gBAAQ,MAAM,MAAM,MAAN,GAAe,CAArB,EAAwB,QAAxB,CAAiC,CAAjC,EAAoC,IAApC,GAA2C,EAAnD;AACH,KAHD,CAGE,OAAO,GAAP,EAAY,CAAE;;AAEhB,WAAO;AACH,gBAAQ,GADL;AAEH,eAAO,KAFJ;AAGH,eAAO;AAHJ,KAAP;AAKH","file":"douyuService.js","sourcesContent":["import api from '../lib/apiService'\nimport request from 'request-promise'\nimport querystring from 'querystring'\nimport cheerio from 'cheerio'\n\n\nexport async function searchLiveRoom(keyword,page=1) {\n    return request(api.searchDouyuLiveRoom + '/search/' + querystring.escape(keyword) + '?' + querystring.stringify({\n            type: 2,\n            page: page\n        }))\n}\n\nexport function formatJsonByHtml(rawHtml) {\n    let $ = cheerio.load(rawHtml);\n\n    let $list_a = $('ul.search_result_list>li>a').toArray();\n    let $list_img = $('ul.search_result_list>li span.img img').toArray();\n    let $list_title = $('ul.search_result_list>li span.title').toArray();\n    let $list_type = $('ul.search_result_list>li span.zbName').toArray();\n    let $list_nick = $('ul.search_result_list>li .moreMes .nnt').toArray();\n    let $list_person = $('ul.search_result_list>li .moreMes .view').toArray();\n    let $list_isliving = $('ul.search_result_list>li i.icon_live').toArray();\n\n    let jsonList = new Array($list_a.length);\n    for (let i = 0; i < $list_a.length; i++) {\n        jsonList[i] = {\n            title: $list_title[i].children[0].data,\n            href: $list_a[i].attribs.href,\n            img: $list_img[i].attribs['data-original'],\n            type: $list_type[i].children[0].data,\n            nick: $list_nick[i].children[0].data,\n            person: $list_person[i].children[0].data,\n            isliving: !!$list_isliving[i]?true:false\n        };\n    }\n\n    let total = 0;\n    try {\n        let $page = $('#turn-page .ui-button:not(.next)').toArray();\n        total = $page[$page.length - 1].children[0].data * 15;\n    } catch (err) {}\n\n    return {\n        status: 200,\n        total: total,\n        items: jsonList\n    };\n}"]}