{"version":3,"sources":["biliService.es6"],"names":[],"mappings":";;;;;;;;wDAMO,iBAA8B,OAA9B;AAAA,YAAsC,IAAtC,yDAA2C,CAA3C;AAAA;AAAA;AAAA;AAAA;AAAA,yDACI,8BAAQ,qBAAI,kBAAJ,GAAyB,GAAzB,IAAgC,OAAO,CAAP,GAAW,IAAX,GAAkB,EAAlD,IAAwD,GAAxD,GAA8D,sBAAY,SAAZ,CAAsB;AAC/F,qCAAS,OADsF;AAE/F,kCAAM;AAFyF,yBAAtB,CAAtE,CADJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAe,c;;;;;QAON,gB,GAAA,gB;;AAbhB;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAUO,SAAS,gBAAT,CAA0B,OAA1B,EAAmC;AACtC,QAAI,IAAI,kBAAQ,IAAR,CAAa,OAAb,CAAR;;AAEA,QAAI,UAAU,EAAE,6BAAF,EAAiC,OAAjC,EAAd;AACA,QAAI,YAAY,EAAE,6BAAF,EAAiC,OAAjC,EAAhB;AACA,QAAI,eAAe,EAAE,yBAAF,EAA6B,OAA7B,EAAnB;AACA,QAAI,cAAc,EAAE,2BAAF,EAA+B,OAA/B,EAAlB;AACA,QAAI,aAAa,EAAE,gCAAF,EAAoC,OAApC,EAAjB;AACA,QAAI,eAAe,EAAE,kCAAF,EAAsC,OAAtC,EAAnB;AACA,QAAI,aAAa,EAAE,4BAAF,EAAgC,OAAhC,EAAjB;;AAEA,QAAI,WAAW,IAAI,KAAJ,CAAU,QAAQ,MAAlB,CAAf;AACA,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,QAAQ,MAA5B,EAAoC,GAApC,EAAyC;AACrC,iBAAS,CAAT,IAAc;AACV,mBAAO,YAAY,CAAZ,EAAe,QAAf,CAAwB,CAAxB,EAA2B,IADxB;AAEV,kBAAM,QAAQ,CAAR,EAAW,OAAX,CAAmB,IAFf;AAGV,iBAAK,UAAU,CAAV,EAAa,OAAb,CAAqB,GAHhB;AAIV,oBAAQ,aAAa,CAAb,EAAgB,OAAhB,CAAwB,GAJtB;AAKV,kBAAM,WAAW,CAAX,EAAc,QAAd,CAAuB,CAAvB,EAA0B,IALtB;AAMV,oBAAQ,aAAa,CAAb,EAAgB,QAAhB,CAAyB,CAAzB,EAA4B,IAN1B;AAOV,sBAAU;AAPA,SAAd;AASH;AACD,QAAI,QAAQ,CAAZ;AACA,QAAI;AACA,gBAAQ,WAAW,WAAW,MAAX,GAAoB,CAA/B,EAAkC,QAAlC,CAA2C,CAA3C,EAA8C,IAA9C,GAAqD,EAA7D;AACH,KAFD,CAEE,OAAO,GAAP,EAAY,CAAE;;AAEhB,WAAO;AACH,gBAAQ,GADL;AAEH,eAAO,KAFJ;AAGH,eAAO;AAHJ,KAAP;AAKH","file":"biliService.js","sourcesContent":["import api from '../lib/apiService'\nimport request from 'request-promise'\nimport querystring from 'querystring'\nimport cheerio from 'cheerio'\n\n\nexport async function searchLiveRoom(keyword,page=1) {\n    return request(api.searchBiliLiveRoom + '/' + (page > 1 ? page : '') + '?' + querystring.stringify({\n        keyword: keyword,\n        type: 'all'\n    }))\n}\n\nexport function formatJsonByHtml(rawHtml) {\n    let $ = cheerio.load(rawHtml);\n\n    let $list_a = $('#list-content .vedioBlock>a').toArray();\n    let $list_img = $('#list-content .listVimg img').toArray();\n    let $list_avatar = $('#list-content .face img').toArray();\n    let $list_title = $('#list-content .listVtitle').toArray();\n    let $list_nick = $('#list-content .upInfo .upTitle').toArray();\n    let $list_person = $('#list-content .upInfo .peopleNum').toArray();\n    let $list_page = $('ul.page>li>:not(.lastpage)').toArray();\n\n    let jsonList = new Array($list_a.length);\n    for (let i = 0; i < $list_a.length; i++) {\n        jsonList[i] = {\n            title: $list_title[i].children[0].data,\n            href: $list_a[i].attribs.href,\n            img: $list_img[i].attribs.src,\n            avatar: $list_avatar[i].attribs.src,\n            nick: $list_nick[i].children[0].data,\n            person: $list_person[i].children[0].data,\n            isliving: true\n        };\n    }\n    let total = 0;\n    try {\n        total = $list_page[$list_page.length - 1].children[0].data * 42;\n    } catch (err) {}\n\n    return {\n        status: 200,\n        total: total,\n        items: jsonList\n    };\n}"]}